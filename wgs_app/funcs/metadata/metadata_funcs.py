from wgs_app.models import *
import pandas as pd
from django.utils.datastructures import MultiValueDictKeyError
from datetime import datetime
import os
from django.db import IntegrityError


def import_metadata(df : pd.DataFrame):
    for index, row in df.iterrows():
        obj, metadata = ReferredDB.objects.update_or_create(
            sample_name = row['accession_no'],
            defaults = 
            {
                'sample_name' : row['accession_no'],
                'referral_date' : row["referral_date"],
                'patient_id' : row["patient_id"],
                'first_name' : row["first_name"],
                'mid_name' : row["mid_name"],
                'last_name' : row["last_name"],
                'date_birth' : row["date_birth"],
                'age' : row["age"],
                'sex' : row["sex"],
                'date_admis' : row["date_admis"],
                'nosocomial' : row["nosocomial"],
                'diagnosis' : row["diagnosis"],
                'diagnosis_icd10' : row["diagnosis_icd10"],
                'ward' : row["ward"],
                'service_type' : row["service_type"],
                'spec_num' : row["spec_num"],
                'spec_date' : row["spec_date"],
                'spec_type' : row["spec_type"],
                'reason' : row["reason"],
                'growth' : row["growth"],
                'urine_colct' : row["urine_colct"],
                'arsrl_pre' : row["arsrl_pre"],
                'arsrl_org' : row["arsrl_org"],
                'organism_code' : row["organism_code"],
                'arsrl_post' : row["arsrl_post"],
                'ampc' : row["ampc"],
                'esbl' : row["esbl"],
                'carb' : row["carb"],
                'mbl' : row["mbl"],
                'bl' : row["bl"],
                'mr' : row["mr"],
                'meca' : row["meca"],
                'icr' : row["icr"],
                'amk_nd30' : row["amk_nd30"],
                'amk_nd30_ris' : row["amk_nd30_ris"],
                'amk_nm' : row["amk_nm"],
                'amk_nm_ris' : row["amk_nm_ris"],
                'amc_nd20' : row["amc_nd20"],
                'amc_nd20_ris' : row["amc_nd20_ris"],
                'amc_nm' : row["amc_nm"],
                'amc_nm_ris' : row["amc_nm_ris"],
                'amp_nd10' : row["amp_nd10"],
                'amp_nd10_ris' : row["amp_nd10_ris"],
                'amp_nm' : row["amp_nm"],
                'amp_nm_ris' : row["amp_nm_ris"],
                'sam_nd10' : row["sam_nd10"],
                'sam_nd10_ris' : row["sam_nd10_ris"],
                'sam_nm' : row["sam_nm"],
                'sam_nm_ris' : row["sam_nm_ris"],
                'atm_nd30' : row["atm_nd30"],
                'atm_nd30_ris' : row["atm_nd30_ris"],
                'atm_nm' : row["atm_nm"],
                'atm_nm_ris' : row["atm_nm_ris"],
                'azm_nd15' : row["azm_nd15"],
                'azm_nd15_ris' : row["azm_nd15_ris"],
                'azm_nm' : row["azm_nm"],
                'azm_nm_ris' : row["azm_nm_ris"],
                'cec_nd30' : row["cec_nd30"],
                'cec_nd30_ris' : row["cec_nd30_ris"],
                'cec_nm' : row["cec_nm"],
                'cec_nm_ris' : row["cec_nm_ris"],
                'czo_nd30' : row["czo_nd30"],
                'czo_nd30_ris' : row["czo_nd30_ris"],
                'czo_nm' : row["czo_nm"],
                'czo_nm_ris' : row["czo_nm_ris"],
                'fep_nd30' : row["fep_nd30"],
                'fep_nd30_ris' : row["fep_nd30_ris"],
                'fep_nm' : row["fep_nm"],
                'fep_nm_ris' : row["fep_nm_ris"],
                'cfm_nd5' : row["cfm_nd5"],
                'cfm_nd5_ris' : row["cfm_nd5_ris"],
                'cfm_nm' : row["cfm_nm"],
                'cfm_nm_ris' : row["cfm_nm_ris"],
                'cfp_nd75' : row["cfp_nd75"],
                'cfp_nd75_ris' : row["cfp_nd75_ris"],
                'cfp_nm' : row["cfp_nm"],
                'cfp_nm_ris' : row["cfp_nm_ris"],
                'ctx_nd30' : row["ctx_nd30"],
                'ctx_nd30_ris' : row["ctx_nd30_ris"],
                'ctx_nm' : row["ctx_nm"],
                'ctx_nm_ris' : row["ctx_nm_ris"],
                'fox_nd30' : row["fox_nd30"],
                'fox_nd30_ris' : row["fox_nd30_ris"],
                'fox_nm' : row["fox_nm"],
                'fox_nm_ris' : row["fox_nm_ris"],
                'caz_nd30' : row["caz_nd30"],
                'caz_nd30_ris' : row["caz_nd30_ris"],
                'caz_nm' : row["caz_nm"],
                'caz_nm_ris' : row["caz_nm_ris"],
                'cro_nd30' : row["cro_nd30"],
                'cro_nd30_ris' : row["cro_nd30_ris"],
                'cro_nm' : row["cro_nm"],
                'cro_nm_ris' : row["cro_nm_ris"],
                'cxa_nd30' : row["cxa_nd30"],
                'cxa_nd30_ris' : row["cxa_nd30_ris"],
                'cxa_nm' : row["cxa_nm"],
                'cxa_nm_ris' : row["cxa_nm_ris"],
                'cep_nd30' : row["cep_nd30"],
                'cep_nd30_ris' : row["cep_nd30_ris"],
                'cep_nm' : row["cep_nm"],
                'cep_nm_ris' : row["cep_nm_ris"],
                'chl_nd30' : row["chl_nd30"],
                'chl_nd30_ris' : row["chl_nd30_ris"],
                'chl_nm' : row["chl_nm"],
                'chl_nm_ris' : row["chl_nm_ris"],
                'cip_nd5' : row["cip_nd5"],
                'cip_nd5_ris' : row["cip_nd5_ris"],
                'cip_nm' : row["cip_nm"],
                'cip_nm_ris' : row["cip_nm_ris"],
                'cli_nd2' : row["cli_nd2"],
                'cli_nd2_ris' : row["cli_nd2_ris"],
                'cli_nm' : row["cli_nm"],
                'cli_nm_ris' : row["cli_nm_ris"],
                'sxt_nd1_2' : row["sxt_nd1_2"],
                'sxt_nd1_2_ris' : row["sxt_nd1_2_ris"],
                'sxt_nm' : row["sxt_nm"],
                'sxt_nm_ris' : row["sxt_nm_ris"],
                'ery_nd15' : row["ery_nd15"],
                'ery_nd15_ris' : row["ery_nd15_ris"],
                'ery_nm' : row["ery_nm"],
                'ery_nm_ris' : row["ery_nm_ris"],
                'gen_nd10' : row["gen_nd10"],
                'gen_nd10_ris' : row["gen_nd10_ris"],
                'gen_nm' : row["gen_nm"],
                'gen_nm_ris' : row["gen_nm_ris"],
                'ipm_nd10' : row["ipm_nd10"],
                'ipm_nd10_ris' : row["ipm_nd10_ris"],
                'ipm_nm' : row["ipm_nm"],
                'ipm_nm_ris' : row["ipm_nm_ris"],
                'kan_nd30' : row["kan_nd30"],
                'kan_nd30_ris' : row["kan_nd30_ris"],
                'kan_nm' : row["kan_nm"],
                'kan_nm_ris' : row["kan_nm_ris"],
                'lev_nd5' : row["lev_nd5"],
                'lev_nd5_ris' : row["lev_nd5_ris"],
                'lev_nm' : row["lev_nm"],
                'lev_nm_ris' : row["lev_nm_ris"],
                'nal_nd30' : row["nal_nd30"],
                'nal_nd30_ris' : row["nal_nd30_ris"],
                'nal_nm' : row["nal_nm"],
                'nal_nm_ris' : row["nal_nm_ris"],
                'nit_nd300' : row["nit_nd300"],
                'nit_nd300_ris' : row["nit_nd300_ris"],
                'nit_nm' : row["nit_nm"],
                'nit_nm_ris' : row["nit_nm_ris"],
                'nor_nd10' : row["nor_nd10"],
                'nor_nd10_ris' : row["nor_nd10_ris"],
                'nor_nm' : row["nor_nm"],
                'nor_nm_ris' : row["nor_nm_ris"],
                'ofl_nd5' : row["ofl_nd5"],
                'ofl_nd5_ris' : row["ofl_nd5_ris"],
                'ofl_nm' : row["ofl_nm"],
                'ofl_nm_ris' : row["ofl_nm_ris"],
                'oxa_nd1' : row["oxa_nd1"],
                'oxa_nd1_ris' : row["oxa_nd1_ris"],
                'oxa_nm' : row["oxa_nm"],
                'oxa_nm_ris' : row["oxa_nm_ris"],
                'pen_nd10' : row["pen_nd10"],
                'pen_nd10_ris' : row["pen_nd10_ris"],
                'pen_nm' : row["pen_nm"],
                'pen_nm_ris' : row["pen_nm_ris"],
                'pip_nd100' : row["pip_nd100"],
                'pip_nd100_ris' : row["pip_nd100_ris"],
                'pip_nm' : row["pip_nm"],
                'pip_nm_ris' : row["pip_nm_ris"],
                'rif_nd5' : row["rif_nd5"],
                'rif_nd5_ris' : row["rif_nd5_ris"],
                'rif_nm' : row["rif_nm"],
                'rif_nm_ris' : row["rif_nm_ris"],
                'spe_nd100' : row["spe_nd100"],
                'spe_nd100_ris' : row["spe_nd100_ris"],
                'spe_nm' : row["spe_nm"],
                'spe_nm_ris' : row["spe_nm_ris"],
                'str_nd10' : row["str_nd10"],
                'str_nd10_ris' : row["str_nd10_ris"],
                'str_nm' : row["str_nm"],
                'str_nm_ris' : row["str_nm_ris"],
                'tcy_nd30' : row["tcy_nd30"],
                'tcy_nd30_ris' : row["tcy_nd30_ris"],
                'tcy_nm' : row["tcy_nm"],
                'tcy_nm_ris' : row["tcy_nm_ris"],
                'tic_nd75' : row["tic_nd75"],
                'tic_nd75_ris' : row["tic_nd75_ris"],
                'tic_nm' : row["tic_nm"],
                'tic_nm_ris' : row["tic_nm_ris"],
                'tcc_nd75' : row["tcc_nd75"],
                'tcc_nd75_ris' : row["tcc_nd75_ris"],
                'tcc_nm' : row["tcc_nm"],
                'tcc_nm_ris' : row["tcc_nm_ris"],
                'tob_nd10' : row["tob_nd10"],
                'tob_nd10_ris' : row["tob_nd10_ris"],
                'tob_nm' : row["tob_nm"],
                'tob_nm_ris' : row["tob_nm_ris"],
                'van_nd30' : row["van_nd30"],
                'van_nd30_ris' : row["van_nd30_ris"],
                'van_nm' : row["van_nm"],
                'van_nm_ris' : row["van_nm_ris"],
                'mfx_nd5' : row["mfx_nd5"],
                'mfx_nd5_ris' : row["mfx_nd5_ris"],
                'mfx_nm' : row["mfx_nm"],
                'mfx_nm_ris' : row["mfx_nm_ris"],
                'mem_nd10' : row["mem_nd10"],
                'mem_nd10_ris' : row["mem_nd10_ris"],
                'mem_nm' : row["mem_nm"],
                'mem_nm_ris' : row["mem_nm_ris"],
                'tzp_nd100' : row["tzp_nd100"],
                'tzp_nd100_ris' : row["tzp_nd100_ris"],
                'tzp_nm' : row["tzp_nm"],
                'tzp_nm_ris' : row["tzp_nm_ris"],
                'geh_nd120' : row["geh_nd120"],
                'geh_nd120_ris' : row["geh_nd120_ris"],
                'geh_nm' : row["geh_nm"],
                'geh_nm_ris' : row["geh_nm_ris"],
                'sth_nd300' : row["sth_nd300"],
                'sth_nd300_ris' : row["sth_nd300_ris"],
                'sth_nm' : row["sth_nm"],
                'sth_nm_ris' : row["sth_nm_ris"],
                'lnz_nd30' : row["lnz_nd30"],
                'lnz_nd30_ris' : row["lnz_nd30_ris"],
                'lnz_nm' : row["lnz_nm"],
                'lnz_nm_ris' : row["lnz_nm_ris"],
                'nov_nd5' : row["nov_nd5"],
                'nov_nd5_ris' : row["nov_nd5_ris"],
                'nov_nm' : row["nov_nm"],
                'nov_nm_ris' : row["nov_nm_ris"],
                'etp_nd10' : row["etp_nd10"],
                'etp_nd10_ris' : row["etp_nd10_ris"],
                'etp_nm' : row["etp_nm"],
                'etp_nm_ris' : row["etp_nm_ris"],
                'dor_nd10' : row["dor_nd10"],
                'dor_nd10_ris' : row["dor_nd10_ris"],
                'dor_nm' : row["dor_nm"],
                'dor_nm_ris' : row["dor_nm_ris"],
                'col_nd10' : row["col_nd10"],
                'col_nd10_ris' : row["col_nd10_ris"],
                'col_nm' : row["col_nm"],
                'col_nm_ris' : row["col_nm_ris"],
                'pol_nd300' : row["pol_nd300"],
                'pol_nd300_ris' : row["pol_nd300_ris"],
                'pol_nm' : row["pol_nm"],
                'pol_nm_ris' : row["pol_nm_ris"],
                'qda_nd15' : row["qda_nd15"],
                'qda_nd15_ris' : row["qda_nd15_ris"],
                'qda_nm' : row["qda_nm"],
                'qda_nm_ris' : row["qda_nm_ris"],
                'mno_nd30' : row["mno_nd30"],
                'mno_nd30_ris' : row["mno_nd30_ris"],
                'mno_nm' : row["mno_nm"],
                'mno_nm_ris' : row["mno_nm_ris"],
                'dap_nd30' : row["dap_nd30"],
                'dap_nd30_ris' : row["dap_nd30_ris"],
                'dap_nm' : row["dap_nm"],
                'dap_nm_ris' : row["dap_nm_ris"],
                'otherab1_name' : row["otherab1_name"],
                'otherab1_disk' : row["otherab1_disk"],
                'otherab1_disk_ris' : row["otherab1_disk_ris"],
                'otherab1_mic' : row["otherab1_mic"],
                'otherab1_mic_ris' : row["otherab1_mic_ris"],
                'otherab2_name' : row["otherab2_name"],
                'otherab2_disk' : row["otherab2_disk"],
                'otherab2_disk_ris' : row["otherab2_disk_ris"],
                'otherab2_mic' : row["otherab2_mic"],
                'otherab2_mic_ris' : row["otherab2_mic_ris"],
                'otherab3_name' : row["otherab3_name"],
                'otherab3_disk' : row["otherab3_disk"],
                'otherab3_disk_ris' : row["otherab3_disk_ris"],
                'otherab3_mic' : row["otherab3_mic"],
                'otherab3_mic_ris' : row["otherab3_mic_ris"],
                'otherab4_name' : row["otherab4_name"],
                'otherab4_disk' : row["otherab4_disk"],
                'otherab4_disk_ris' : row["otherab4_disk_ris"],
                'otherab4_mic' : row["otherab4_mic"],
                'otherab4_mic_ris' : row["otherab4_mic_ris"],
                'otherab5_name' : row["otherab5_name"],
                'otherab5_disk' : row["otherab5_disk"],
                'otherab5_disk_ris' : row["otherab5_disk_ris"],
                'otherab5_mic' : row["otherab5_mic"],
                'otherab5_mic_ris' : row["otherab5_mic_ris"],
            },
        )
    return 'success'